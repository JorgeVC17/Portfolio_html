```{r setup 4, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(readxl)
library(toolboxr)
```

# C. elegans plate experiment

The data for this exercise was kindly supplied by J. Louter (INT/ILC) and was derived from an experiment in which adult C.elegans nematodes were exposed to varying concentrations of different compounds. The variables **RawData** (the outcome - number of offspring counted as an integer value, after incubation time), **compName** (the generic name of the compound/chemical), the **compConcentration** (the concentration of the compound), and the **expType** are the most important variables in this dataset.

A typical analysis with this data would be to run a dose-response analysis using a log-logistic model with estimates for the maximal, the minimal, the IC50 concentration and the slope at IC50.

## Inspect file

```{r Open file, echo=TRUE, message=FALSE}
experiment <- read_excel(here::here("rmd_files/rmd_data/celegans_plate_data/CE.LIQ.FLOW.062_Tidydata.xlsx"))


knitr::kable(head(experiment))

```

### Inspect data/variabels

**Raw Data**

  - Expected type of data = **Numeric (Integer)**

  - Type of data = **`r typeof(experiment$RawData)`**

**compName**

  - Expected type of data = **character**

  - Type of data = **`r typeof(experiment$RawData)`**

**compConcentration**

  - Expected type of data = **Numeric (Double)**

  - Type of data = **`r typeof(experiment$compConcentration)`**

#### Changing type of data

```{r, echo=TRUE, message=FALSE}

experiment$compConcentration <- as.numeric(experiment$compConcentration)

```

Type of data now = **`r typeof(experiment$compConcentration)`**

## Making a scatterplot

```{r, echo=TRUE, message=FALSE}
experiment %>% ggplot(aes(x=log10(compConcentration), y=RawData, 
                          group = compName, colour = compName, 
                          shape = expType)) +
  geom_jitter(na.rm = TRUE)+
 theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)) +
  labs(title = "Scatterplot for C.elegans plate experiment",
       x="Log_Compound Concentration",
       y="Count offspring",
       color = "Compound Name",  
       shape = "Type of experiment")
  
```

The positive control for this experiments is **Ethanol.**

The negative control for this experiment is **S-medium**


